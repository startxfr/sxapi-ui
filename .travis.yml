env:
  global:
    - secure: "aVbcUL8J/yKV0tXQYzzbxrssnzxEJdiwd28ROWHBL00e/aBeyPS6Jz8ArHUoW2KfD0tkK1J281iErI9NaqQLOuxO4Qam1ZuqqNFvLzrZIzfAxm3BogEIEl+qb7mh3KgxPCuqIzfIalzMJq1j3/iq52oyhcpsGL0yqiH6AcQKp8WddFCGAA+ZW+t3Vkpq8Qo8p8kXbdrz2ZStNFpGdypS0WAQugfnGFfwUC4wmhRM/SdDJluzgLAh8fSVRxDwk9ZaOSbCfx/74iN8jNTZhINbp7ky5R8f4Y57p+6/3zfYHPnpO+IwbcDKO4+7SCe5HTzBAirNcsBLuXGmxCPEz8NIIZJpVTf08NotygEuufuNn/51fuL2Dkf2c4g9J4672Lbr1I7SXhPXLxUrKjCN9UNItFj7UlePSFzxqc97225ohI8TsL+grPOLtXaTRPO/rnfk/s+Yl7nWKSBlrdHZGoq/75TZq1V99oAdORw9g4wIj3+qLpiAbsdS+50nSmwUCWa/9SHiwBuLFnS1qQF2izo2b+P1hGfIjSOdyfmfOD0k14COM+7ES4mViEEGnVHTTHpHzh307UYRjk9hwQrFs6rv5sapGy/t6YnwlqfRpwrFY6S2/ZWpdNy8Z+hK8/Y3Z7OKnwkUNHUJYn281oTAxfBE09XSCZa9d6U2XoI3b0rDHkA=" # DOCKER_USER
    - secure: "jLajitkfo1HV6628RXZCAGT+3Sy4kcaTSxQKnX6c0LqtRLGutqbF4hliGxvA3yFQqTgzrdF4TKe8Btss2v0DbdTtdP6CkHSkcwTAIwSaSV2rUmRh6gxi7TlcgYKh8sRlv8+nFlDBMek2200yM51wviveO/2hTtSk0ppbqoJnZM3aqdY7uxwUL35Drwk2a1sOSQPzc1xvJ8lxA8qf7ZhVXkYT5++cNVp++lxu/PncXWKdxJmDDOJKvjGMes4UokVU9KSzoi4Ft7G4HvjXgPgcU33RVx2eIuQaT7YSL8mo6CGX6EhzdbnY0L6zxznb/MR7q3e9oDdYxYSlhcfEbNYN+A6V9HM/0NqJEIgL/DElzGvSTsXcYDE+MVV1p/ZJMlSaYQamAS60xm3n+FpyVnMQOKLtAfVwdP4YTKyKnP1I8kflGMOGf1TPdfm4u4koQ7D6csB/GBOpEew7bURLpC+2IftCdSP7Adat/3Icieuff3F9twmHYNdtK2Jy4pRLUfRAfMAYb/xIUtWxoZxuoz1o9selWWmFxoL4IRYHykh2g+dJy/xb41J5QvzzHZfCcPFZQNWNT8QjNfLJP0PW8xMgz04aPK6XDNcqErUiIIffiM/MOAGM1Jwm4YTpXW7HpUHttIDyUs2s5OsCQFBDnu/L8lorFz5sTvG7Xmu6Tma5+ww=" # DOCKER_PASS
    - COMMIT=${TRAVIS_COMMIT::8}
    - REPO=startx/sxapi-ui
    - RELEASE=0.0.3

sudo: required

services:
  - docker

before_install:
- docker pull startx/sxapi:0.0.77
- docker images

script: ./travis.sh

after_success:
  - docker login -u $DOCKER_USER -p $DOCKER_PASS
  - export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; elif [ "$TRAVIS_BRANCH" == "testing" ]; then echo "testing"; else echo $RELEASE ; fi`
  - docker build -f Dockerfile -t $REPO:$COMMIT .
  - docker tag $REPO:$COMMIT $REPO:$TAG
  - docker push $REPO
